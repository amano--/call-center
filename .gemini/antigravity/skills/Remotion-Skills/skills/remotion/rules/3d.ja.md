---
name: 3d
description: Remotionで Three.js と React Three Fiber を使用した 3D コンテンツ
metadata:
  tags: 3d, three, threejs
---

# Remotion での Three.js と React Three Fiber の使用

React Three Fiber と Three.js のベストプラクティスに従ってください。
従う必要のある Remotion 固有のルールは以下の通りです。

## 前提条件

まず、`@remotion/three` パッケージをインストールする必要があります。
インストールされていない場合は、以下のコマンドを使用してください。

```bash
npx remotion add @remotion/three # npm を使用する場合
bunx remotion add @remotion/three # bun を使用する場合
yarn remotion add @remotion/three # yarn を使用する場合
pnpm exec remotion add @remotion/three # pnpm を使用する場合
```

## ThreeCanvas を使用する

3D コンテンツを `<ThreeCanvas>` でラップして、適切なライティングを含める必要があります。
`<ThreeCanvas>` は `width` と `height` プロップを持つ必要があります。

```tsx
import { ThreeCanvas } from "@remotion/three";
import { useVideoConfig } from "remotion";

const { width, height } = useVideoConfig();

<ThreeCanvas width={width} height={height}>
  <ambientLight intensity={0.4} />
  <directionalLight position={[5, 5, 5]} intensity={0.8} />
  <mesh>
    <sphereGeometry args={[1, 32, 32]} />
    <meshStandardMaterial color="red" />
  </mesh>
</ThreeCanvas>;
```

## `useCurrentFrame()` で駆動されていないアニメーションはない

シェーダー、モデルなどは自動的にアニメーションを行わないようにしてください。
`useCurrentFrame()` で駆動されない限り、アニメーションは許可されません。
そうしないと、レンダリング中にちらつきが発生します。

`@react-three/fiber` の `useFrame()` を使用することは禁止されています。

## `useCurrentFrame()` を使用してアニメーション化する

`useCurrentFrame()` を使用してアニメーションを実行してください。

```tsx
const frame = useCurrentFrame();
const rotationY = frame * 0.02;

<mesh rotation={[0, rotationY, 0]}>
  <boxGeometry args={[2, 2, 2]} />
  <meshStandardMaterial color="#4a9eff" />
</mesh>;
```

## `<ThreeCanvas>` 内で `<Sequence>` を使用する

`<ThreeCanvas>` 内のあらゆる `<Sequence>` の `layout` プロップを `none` に設定する必要があります。

```tsx
import { Sequence } from "remotion";
import { ThreeCanvas } from "@remotion/three";

const { width, height } = useVideoConfig();

<ThreeCanvas width={width} height={height}>
  <Sequence layout="none">
    <mesh>
      <boxGeometry args={[2, 2, 2]} />
      <meshStandardMaterial color="#4a9eff" />
    </mesh>
  </Sequence>
</ThreeCanvas>;
```
